<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arnaud's Transformation - 6 Mois</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #151a35;
            --bg-card: #1a1f3a;
            --accent-fire: #ff6b35;
            --accent-success: #4ecdc4;
            --accent-warning: #ffd166;
            --accent-bulk: #a855f7;
            --text-primary: #ffffff;
            --text-secondary: #a8b2d1;
            --border: #2d3561;
            --gradient-fire: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            --gradient-success: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            --gradient-bulk: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
            --shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Header */
        .header {
            text-align: center;
            padding: 3rem 0;
            position: relative;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 200px;
            background: radial-gradient(circle at center, rgba(255, 107, 53, 0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        
        h1 {
            font-size: 3rem;
            font-weight: 900;
            background: var(--gradient-fire);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -2px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .phase-badge {
            display: inline-block;
            padding: 0.6rem 1.8rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-top: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .phase-cut {
            background: var(--gradient-fire);
        }
        
        .phase-transition {
            background: var(--gradient-success);
        }
        
        .phase-bulk {
            background: var(--gradient-bulk);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Timeline */
        .timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 3rem 0;
            padding: 2rem;
            background: var(--bg-card);
            border-radius: 20px;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-fire) 0%, var(--accent-success) 35%, var(--accent-bulk) 70%);
            transform: translateY(-50%);
            z-index: 0;
        }
        
        .timeline-item {
            position: relative;
            z-index: 1;
            text-align: center;
            flex: 1;
        }
        
        .timeline-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 4px solid var(--border);
            margin: 0 auto 0.5rem;
            transition: all 0.3s ease;
        }
        
        .timeline-item.active .timeline-dot {
            width: 32px;
            height: 32px;
            border-color: var(--accent-fire);
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.6);
        }
        
        .timeline-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .timeline-item.active .timeline-label {
            color: var(--accent-fire);
            font-weight: 700;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 3rem 0;
        }
        
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, var(--accent-fire) 0%, transparent 70%);
            opacity: 0.1;
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-fire);
        }
        
        .stat-subtext {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        
        /* Phase Info Banner */
        .phase-info {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 2rem;
        }
        
        .phase-info-item {
            text-align: center;
        }
        
        .phase-info-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .phase-info-value {
            font-size: 1.5rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        
        /* Input Section */
        .input-section {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 24px;
            padding: 2.5rem;
            margin: 2rem 0;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .section-title::before {
            content: 'üî•';
            font-size: 1.8rem;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        input[type="number"],
        input[type="date"] {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            font-size: 1.1rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        input:focus {
            outline: none;
            border-color: var(--accent-fire);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }
        
        .btn {
            background: var(--gradient-fire);
            border: none;
            padding: 1.2rem 2.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            color: white;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(255, 107, 53, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        /* Charts */
        .chart-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .chart-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        
        canvas {
            max-height: 400px;
        }
        
        /* Goals */
        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .goal-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
        }
        
        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .goal-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
        }
        
        .goal-status {
            font-size: 0.9rem;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .status-on-track {
            background: rgba(78, 205, 196, 0.2);
            color: var(--accent-success);
        }
        
        .status-warning {
            background: rgba(255, 209, 102, 0.2);
            color: var(--accent-warning);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gradient-success);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .goal-values {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .current-value {
            font-weight: 700;
            color: var(--accent-fire);
        }
        
        /* History Table */
        .history-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .history-table th {
            text-align: left;
            padding: 1rem;
            border-bottom: 2px solid var(--border);
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }
        
        .history-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .history-table tr:hover {
            background: var(--bg-secondary);
        }
        
        .trend-up {
            color: var(--accent-success);
        }
        
        .trend-down {
            color: var(--accent-fire);
        }
        
        /* Alerts */
        .alert {
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .alert-success {
            background: rgba(78, 205, 196, 0.15);
            border: 1px solid var(--accent-success);
            color: var(--accent-success);
        }
        
        .alert-warning {
            background: rgba(255, 209, 102, 0.15);
            border: 1px solid var(--accent-warning);
            color: var(--accent-warning);
        }
        
        .alert-icon {
            font-size: 1.5rem;
        }
        
        /* Predictions */
        .prediction-card {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .prediction-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--accent-bulk);
        }
        
        .prediction-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .prediction-item {
            text-align: center;
        }
        
        .prediction-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .prediction-value {
            font-size: 2rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            background: var(--gradient-bulk);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .phase-info {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .timeline {
                flex-direction: column;
                gap: 1rem;
            }
            
            .container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Transformation Compl√®te</h1>
            <p class="subtitle">5 Janvier - 30 Juin 2026 ‚Ä¢ 6 Mois</p>
            <div class="phase-badge" id="currentPhaseBadge">Phase 1 : Mini-Cut</div>
        </div>

        <!-- Timeline -->
        <div class="timeline">
            <div class="timeline-item" id="timelinePhase1">
                <div class="timeline-dot"></div>
                <div class="timeline-label">Phase 1<br>Mini-Cut<br>5 Jan - 2 Mar</div>
            </div>
            <div class="timeline-item" id="timelinePhase2">
                <div class="timeline-dot"></div>
                <div class="timeline-label">Phase 2<br>Transition<br>2-15 Mar</div>
            </div>
            <div class="timeline-item" id="timelinePhase3">
                <div class="timeline-dot"></div>
                <div class="timeline-label">Phase 3<br>Prise de Masse<br>16 Mar - 30 Juin</div>
            </div>
        </div>

        <!-- Phase Info -->
        <div class="phase-info">
            <div class="phase-info-item">
                <div class="phase-info-label">Objectif de Phase</div>
                <div class="phase-info-value" id="phaseGoal">76-77kg</div>
            </div>
            <div class="phase-info-item">
                <div class="phase-info-label">Calories Quotidiennes</div>
                <div class="phase-info-value" id="phaseCalories">2450 kcal</div>
            </div>
            <div class="phase-info-item">
                <div class="phase-info-label" id="phaseDaysLabel">Jours Restants Phase</div>
                <div class="phase-info-value" id="phaseDaysLeft">--</div>
            </div>
        </div>

        <!-- Current Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Poids Actuel</div>
                <div class="stat-value" id="currentWeight">--</div>
                <div class="stat-subtext">D√©part: <span id="startWeight">80kg</span></div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Progression Totale</div>
                <div class="stat-value" id="totalProgress">--</div>
                <div class="stat-subtext">sur 6 mois</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Jours Total</div>
                <div class="stat-value" id="totalDays">0</div>
                <div class="stat-subtext">sur 194 jours</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Variation Poids</div>
                <div class="stat-value" id="weightChange">--</div>
                <div class="stat-subtext">depuis le d√©but</div>
            </div>
        </div>

        <!-- Daily Input -->
        <div class="input-section">
            <h2 class="section-title">Enregistrer Aujourd'hui</h2>
            <div class="input-grid">
                <div class="input-group">
                    <label for="date">Date</label>
                    <input type="date" id="date" required>
                </div>
                <div class="input-group">
                    <label for="weight">Poids (kg)</label>
                    <input type="number" id="weight" step="0.1" placeholder="80.0" required>
                </div>
                <div class="input-group">
                    <label for="waist">Tour de Taille (cm)</label>
                    <input type="number" id="waist" step="0.5" placeholder="85.0">
                </div>
            </div>
            <br>
            <button class="btn" onclick="saveEntry()">üíæ Enregistrer</button>
        </div>

        <!-- Alerts -->
        <div id="alertContainer"></div>

        <!-- Weekly Goals -->
        <div class="input-section">
            <h2 class="section-title">Objectifs de la Semaine</h2>
            <div class="goals-grid">
                <div class="goal-card">
                    <div class="goal-header">
                        <div class="goal-title" id="weeklyGoalTitle">Perte Hebdomadaire</div>
                        <div class="goal-status status-on-track" id="weeklyStatus">En cours</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="weeklyProgress" style="width: 0%"></div>
                    </div>
                    <div class="goal-values">
                        <span><span class="current-value" id="weeklyChange">0.0kg</span></span>
                        <span id="weeklyTarget">Objectif: 0.4-0.5kg</span>
                    </div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <div class="goal-title">Tour de Taille</div>
                        <div class="goal-status status-on-track" id="waistStatus">En cours</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="waistProgress" style="width: 0%"></div>
                    </div>
                    <div class="goal-values">
                        <span><span class="current-value" id="waistChange">0.0cm</span></span>
                        <span id="waistTarget">Objectif: -1cm/semaine</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Weight Chart -->
        <div class="chart-container">
            <h2 class="chart-title">üìä √âvolution Compl√®te (6 Mois)</h2>
            <canvas id="mainChart"></canvas>
        </div>

        <!-- Phase Chart -->
        <div class="chart-container">
            <h2 class="chart-title">üéØ Zoom Phase Actuelle</h2>
            <canvas id="phaseChart"></canvas>
        </div>

        <!-- Predictions -->
        <div class="prediction-card">
            <div class="prediction-title">üîÆ Pr√©dictions Fin de Transformation (30 Juin)</div>
            <div class="prediction-grid">
                <div class="prediction-item">
                    <div class="prediction-label">Poids Final</div>
                    <div class="prediction-value" id="predictedWeight">85-86kg</div>
                </div>
                <div class="prediction-item">
                    <div class="prediction-label">Muscle Gagn√©</div>
                    <div class="prediction-value" id="predictedMuscle">+6-7kg</div>
                </div>
                <div class="prediction-item">
                    <div class="prediction-label">Squat</div>
                    <div class="prediction-value" id="predictedSquat">85-90kg</div>
                </div>
                <div class="prediction-item">
                    <div class="prediction-label">D√©velopp√© Inclin√©</div>
                    <div class="prediction-value" id="predictedBench">72-76kg</div>
                </div>
            </div>
        </div>

        <!-- Strength Tracking -->
        <div class="input-section">
            <h2 class="section-title">üí™ Progression Force</h2>
            <div class="input-grid">
                <div class="input-group">
                    <label>Squat (kg)</label>
                    <input type="number" id="squat" placeholder="60" step="2.5">
                </div>
                <div class="input-group">
                    <label>D√©velopp√© Inclin√© (kg)</label>
                    <input type="number" id="bench" placeholder="55" step="2.5">
                </div>
                <div class="input-group">
                    <label>Soulev√© de Terre (kg)</label>
                    <input type="number" id="deadlift" placeholder="50" step="2.5">
                </div>
                <div class="input-group">
                    <label>Presse Convergente (kg)</label>
                    <input type="number" id="press" placeholder="66" step="2.5">
                </div>
            </div>
            <br>
            <button class="btn" onclick="saveStrength()">üí™ Enregistrer les Charges</button>
        </div>

        <!-- Strength Chart -->
        <div class="chart-container">
            <h2 class="chart-title">üìà √âvolution des Charges</h2>
            <canvas id="strengthChart"></canvas>
        </div>

        <!-- History Table -->
        <div class="history-container">
            <h2 class="chart-title">üìù Historique Complet</h2>
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Phase</th>
                        <th>Poids</th>
                        <th>Variation</th>
                        <th>Tour de Taille</th>
                        <th>Calories</th>
                    </tr>
                </thead>
                <tbody id="historyBody">
                    <tr>
                        <td colspan="6" style="text-align: center; color: var(--text-secondary);">Aucune donn√©e enregistr√©e</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Phase Configuration
        const PHASES = {
            PRESTART: {
                name: 'Pr√©paration',
                start: new Date('2025-12-19'), // D√©but du tracking
                end: new Date('2026-01-05'),
                startWeight: 80,
                targetWeight: 80, // Maintien
                weeklyTarget: 0,
                caloriesBase: 0, // Pas de restriction avant le d√©but
                badge: 'phase-cut'
            },
            PHASE1: {
                name: 'Phase 1 : Mini-Cut',
                start: new Date('2026-01-05'),
                end: new Date('2026-03-02'),
                startWeight: 80,
                targetWeight: 76.5,
                weeklyTarget: -0.45,
                caloriesBase: 2400,
                caloriesWeeks: [
                    {week: 0, calories: 2400},
                    {week: 2, calories: 2400},
                    {week: 4, calories: 2450},
                    {week: 6, calories: 2500}
                ],
                badge: 'phase-cut'
            },
            PHASE2: {
                name: 'Phase 2 : Transition',
                start: new Date('2026-03-02'),
                end: new Date('2026-03-16'),
                startWeight: 76.5,
                targetWeight: 77,
                weeklyTarget: 0.25,
                caloriesBase: 2750,
                caloriesWeeks: [
                    {week: 0, calories: 2700},
                    {week: 1, calories: 2850}
                ],
                badge: 'phase-transition'
            },
            PHASE3: {
                name: 'Phase 3 : Prise de Masse',
                start: new Date('2026-03-16'),
                end: new Date('2026-06-30'),
                startWeight: 77,
                targetWeight: 85.5,
                weeklyTarget: 0.30,
                caloriesBase: 3050,
                caloriesWeeks: [
                    {week: 0, calories: 3000},
                    {week: 8, calories: 3100}
                ],
                badge: 'phase-bulk'
            }
        };

        // Data storage
        let weightData = JSON.parse(localStorage.getItem('weightData')) || [];
        let strengthData = JSON.parse(localStorage.getItem('strengthData')) || [];
        
        // Set today's date
        document.getElementById('date').valueAsDate = new Date();
        
        // CONFIGURATION DE TEST - D√©commenter pour forcer une date de test
        // const TEST_DATE = new Date('2025-12-18'); // Avant le d√©but
        // const TEST_DATE = new Date('2026-01-10'); // Phase 1
        // const TEST_DATE = new Date('2026-03-05'); // Phase 2
        // const TEST_DATE = new Date('2026-04-20'); // Phase 3
        const TEST_DATE = null; // Production normale (utilise la vraie date)
        
        // Get current phase
        function getCurrentPhase(date = null) {
            // Utiliser TEST_DATE si d√©fini, sinon la vraie date
            if (date === null) {
                date = TEST_DATE || new Date();
            }
            
            console.log('=== DEBUG getCurrentPhase ===');
            console.log('Date test√©e:', date);
            console.log('Pr√©-start:', PHASES.PRESTART.start);
            console.log('Phase 1 start:', PHASES.PHASE1.start);
            console.log('Phase 2 start:', PHASES.PHASE2.start);
            console.log('Phase 3 start:', PHASES.PHASE3.start);
            
            // Avant le tracking (avant 19 d√©cembre 2025)
            if (date < PHASES.PRESTART.start) {
                console.log('R√©sultat: TROP T√îT (avant tracking)');
                return PHASES.PRESTART;
            }
            
            // P√©riode pr√©-d√©marrage (19 d√©c - 5 jan)
            if (date >= PHASES.PRESTART.start && date < PHASES.PHASE1.start) {
                console.log('R√©sultat: PR√â-D√âMARRAGE');
                return PHASES.PRESTART;
            }
            
            // Phase 1: Mini-Cut
            if (date >= PHASES.PHASE1.start && date < PHASES.PHASE2.start) {
                console.log('R√©sultat: PHASE 1');
                return PHASES.PHASE1;
            }
            
            // Phase 2: Transition
            if (date >= PHASES.PHASE2.start && date < PHASES.PHASE3.start) {
                console.log('R√©sultat: PHASE 2');
                return PHASES.PHASE2;
            }
            
            // Phase 3: Prise de masse
            if (date >= PHASES.PHASE3.start && date <= PHASES.PHASE3.end) {
                console.log('R√©sultat: PHASE 3');
                return PHASES.PHASE3;
            }
            
            // Apr√®s la fin (30 juin)
            console.log('R√©sultat: APR√àS LA FIN (Phase 3)');
            return PHASES.PHASE3;
        }
        
        // Get phase for a specific date
        function getPhaseForDate(date) {
            const d = new Date(date);
            if (d < PHASES.PRESTART.start) return 'Avant tracking';
            if (d < PHASES.PHASE1.start) return 'Pr√©paration';
            if (d < PHASES.PHASE2.start) return 'Phase 1';
            if (d < PHASES.PHASE3.start) return 'Phase 2';
            return 'Phase 3';
        }
        
        // Get target calories for date
        function getTargetCalories(date) {
            const phase = getCurrentPhase(date);
            
            // P√©riode pr√©-d√©marrage : pas de restriction calorique
            if (phase === PHASES.PRESTART) {
                return 0; // Pas de restriction
            }
            
            const weekInPhase = Math.floor((date - phase.start) / (1000 * 60 * 60 * 24 * 7));
            
            let calories = phase.caloriesBase;
            for (let i = phase.caloriesWeeks.length - 1; i >= 0; i--) {
                if (weekInPhase >= phase.caloriesWeeks[i].week) {
                    calories = phase.caloriesWeeks[i].calories;
                    break;
                }
            }
            return calories;
        }
        
        // Get expected weight for date
        function getExpectedWeight(date) {
            let weight = PHASES.PHASE1.startWeight;
            const d = new Date(date);
            
            // Phase 1
            if (d >= PHASES.PHASE1.start && d <= PHASES.PHASE1.end) {
                const weeks = (d - PHASES.PHASE1.start) / (1000 * 60 * 60 * 24 * 7);
                weight = PHASES.PHASE1.startWeight + (weeks * PHASES.PHASE1.weeklyTarget);
            }
            // Phase 2
            else if (d >= PHASES.PHASE2.start && d <= PHASES.PHASE2.end) {
                weight = PHASES.PHASE1.targetWeight;
                const weeks = (d - PHASES.PHASE2.start) / (1000 * 60 * 60 * 24 * 7);
                weight += (weeks * PHASES.PHASE2.weeklyTarget);
            }
            // Phase 3
            else if (d >= PHASES.PHASE3.start) {
                weight = PHASES.PHASE2.targetWeight;
                const weeks = Math.min(
                    (d - PHASES.PHASE3.start) / (1000 * 60 * 60 * 24 * 7),
                    (PHASES.PHASE3.end - PHASES.PHASE3.start) / (1000 * 60 * 60 * 24 * 7)
                );
                weight += (weeks * PHASES.PHASE3.weeklyTarget);
            }
            
            return weight;
        }
        
        // Calculate total days elapsed
        function getTotalDaysElapsed() {
            const today = TEST_DATE || new Date();
            const start = PHASES.PRESTART.start; // D√©but du tracking (19 d√©cembre)
            return Math.max(0, Math.floor((today - start) / (1000 * 60 * 60 * 24)));
        }
        
        // Update phase UI
        function updatePhaseUI() {
            const currentPhase = getCurrentPhase();
            const today = TEST_DATE || new Date();
            
            console.log('=== DEBUG updatePhaseUI ===');
            console.log('Today:', today);
            console.log('PHASES.PHASE1.start:', PHASES.PHASE1.start);
            console.log('today < PHASES.PHASE1.start:', today < PHASES.PHASE1.start);
            
            // Check if before start
            const isBeforeStart = today < PHASES.PHASE1.start;
            const isPreStart = currentPhase === PHASES.PRESTART;
            console.log('isBeforeStart:', isBeforeStart);
            console.log('isPreStart:', isPreStart);
            
            // Update badge
            const badge = document.getElementById('currentPhaseBadge');
            if (isPreStart) {
                console.log('Affichage: PR√âPARATION');
                badge.textContent = 'üìä P√©riode de Suivi Pr√©-D√©marrage';
                badge.className = 'phase-badge phase-cut';
                badge.style.opacity = '0.8';
            } else {
                console.log('Affichage: Phase active -', currentPhase.name);
                badge.textContent = currentPhase.name;
                badge.className = 'phase-badge ' + currentPhase.badge;
                badge.style.opacity = '1';
            }
            
            // Update timeline
            document.getElementById('timelinePhase1').classList.remove('active');
            document.getElementById('timelinePhase2').classList.remove('active');
            document.getElementById('timelinePhase3').classList.remove('active');
            
            if (!isBeforeStart) {
                if (currentPhase === PHASES.PHASE1) {
                    document.getElementById('timelinePhase1').classList.add('active');
                } else if (currentPhase === PHASES.PHASE2) {
                    document.getElementById('timelinePhase2').classList.add('active');
                } else {
                    document.getElementById('timelinePhase3').classList.add('active');
                }
            }
            
            // Update phase info
            if (isPreStart) {
                const daysUntilStart = Math.ceil((PHASES.PHASE1.start - today) / (1000 * 60 * 60 * 24));
                document.getElementById('phaseGoal').textContent = 'Tracking Poids';
                document.getElementById('phaseCalories').textContent = 'Libre';
                document.getElementById('phaseDaysLabel').textContent = 'Jours Avant Phase 1';
                document.getElementById('phaseDaysLeft').textContent = daysUntilStart;
            } else {
                document.getElementById('phaseGoal').textContent = 
                    currentPhase === PHASES.PHASE1 ? '76-77kg' :
                    currentPhase === PHASES.PHASE2 ? 'Maintien 76-77kg' :
                    '85-86kg';
                
                document.getElementById('phaseCalories').textContent = getTargetCalories(today) + ' kcal';
                
                document.getElementById('phaseDaysLabel').textContent = 'Jours Restants Phase';
                const daysLeft = Math.ceil((currentPhase.end - today) / (1000 * 60 * 60 * 24));
                document.getElementById('phaseDaysLeft').textContent = Math.max(0, daysLeft);
            }
            
            // Update weekly goal labels based on phase
            if (currentPhase === PHASES.PHASE1) {
                document.getElementById('weeklyGoalTitle').textContent = 'Perte Hebdomadaire';
                document.getElementById('weeklyTarget').textContent = 'Objectif: -0.4 √† -0.5kg';
                document.getElementById('waistTarget').textContent = 'Objectif: -1cm/semaine';
            } else if (currentPhase === PHASES.PHASE2) {
                document.getElementById('weeklyGoalTitle').textContent = 'Maintien';
                document.getElementById('weeklyTarget').textContent = 'Objectif: ¬±0.2kg';
                document.getElementById('waistTarget').textContent = 'Objectif: Stable';
            } else {
                document.getElementById('weeklyGoalTitle').textContent = 'Gain Hebdomadaire';
                document.getElementById('weeklyTarget').textContent = 'Objectif: +0.25 √† +0.35kg';
                document.getElementById('waistTarget').textContent = 'Objectif: Stable';
            }
        }
        
        // Save entry
        function saveEntry() {
            const date = document.getElementById('date').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const waist = parseFloat(document.getElementById('waist').value);
            
            if (!date || !weight) {
                showAlert('‚ö†Ô∏è Veuillez remplir au moins la date et le poids', 'warning');
                return;
            }
            
            // V√©rifier que la date n'est pas avant le 19 d√©cembre 2025
            const entryDate = new Date(date);
            if (entryDate < PHASES.PRESTART.start) {
                showAlert('‚ö†Ô∏è Le tracking commence le 19 d√©cembre 2025', 'warning');
                return;
            }
            
            const calories = getTargetCalories(new Date(date));
            
            const entry = {
                date: date,
                weight: weight,
                waist: waist || null,
                calories: calories,
                phase: getPhaseForDate(date)
            };
            
            weightData = weightData.filter(e => e.date !== date);
            weightData.push(entry);
            weightData.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            localStorage.setItem('weightData', JSON.stringify(weightData));
            
            showAlert('‚úÖ Donn√©es enregistr√©es avec succ√®s !', 'success');
            updateDashboard();
            
            document.getElementById('weight').value = '';
            document.getElementById('waist').value = '';
        }
        
        // Save strength
        function saveStrength() {
            const date = document.getElementById('date').value;
            const squat = parseFloat(document.getElementById('squat').value);
            const bench = parseFloat(document.getElementById('bench').value);
            const deadlift = parseFloat(document.getElementById('deadlift').value);
            const press = parseFloat(document.getElementById('press').value);
            
            if (!date) {
                showAlert('‚ö†Ô∏è Veuillez s√©lectionner une date', 'warning');
                return;
            }
            
            const entry = {
                date: date,
                squat: squat || null,
                bench: bench || null,
                deadlift: deadlift || null,
                press: press || null
            };
            
            strengthData = strengthData.filter(e => e.date !== date);
            strengthData.push(entry);
            strengthData.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            localStorage.setItem('strengthData', JSON.stringify(strengthData));
            
            showAlert('üí™ Charges enregistr√©es avec succ√®s !', 'success');
            updateStrengthChart();
            
            document.getElementById('squat').value = '';
            document.getElementById('bench').value = '';
            document.getElementById('deadlift').value = '';
            document.getElementById('press').value = '';
        }
        
        // Show alert
        function showAlert(message, type) {
            const container = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <span class="alert-icon">${type === 'success' ? '‚úÖ' : '‚ö†Ô∏è'}</span>
                <span>${message}</span>
            `;
            container.innerHTML = '';
            container.appendChild(alert);
            
            setTimeout(() => {
                alert.style.opacity = '0';
                setTimeout(() => alert.remove(), 300);
            }, 4000);
        }
        
        // Update dashboard
        function updateDashboard() {
            updatePhaseUI();
            
            const totalDays = getTotalDaysElapsed();
            document.getElementById('totalDays').textContent = totalDays;
            
            if (weightData.length > 0) {
                const latestEntry = weightData[weightData.length - 1];
                const currentWeight = latestEntry.weight;
                document.getElementById('currentWeight').textContent = currentWeight.toFixed(1) + 'kg';
                
                const weightChange = currentWeight - PHASES.PHASE1.startWeight;
                const changeText = weightChange >= 0 ? '+' + weightChange.toFixed(1) : weightChange.toFixed(1);
                document.getElementById('weightChange').textContent = changeText + 'kg';
                
                const progressPercent = ((currentWeight - PHASES.PHASE1.startWeight) / (PHASES.PHASE3.targetWeight - PHASES.PHASE1.startWeight) * 100).toFixed(1);
                document.getElementById('totalProgress').textContent = progressPercent + '%';
                
                // Weekly progress
                const today = TEST_DATE || new Date();
                const lastWeekData = weightData.filter(e => {
                    const entryDate = new Date(e.date);
                    return (today - entryDate) <= 7 * 24 * 60 * 60 * 1000;
                }).sort((a, b) => new Date(a.date) - new Date(b.date));
                
                if (lastWeekData.length >= 2) {
                    const weeklyChange = latestEntry.weight - lastWeekData[0].weight;
                    const changeSign = weeklyChange >= 0 ? '+' : '';
                    document.getElementById('weeklyChange').textContent = changeSign + weeklyChange.toFixed(2) + 'kg';
                    
                    const currentPhase = getCurrentPhase();
                    let weeklyProgress = 0;
                    let isOnTrack = false;
                    
                    if (currentPhase === PHASES.PHASE1) {
                        weeklyProgress = Math.min(Math.abs(weeklyChange / 0.45) * 100, 100);
                        isOnTrack = weeklyChange <= -0.4 && weeklyChange >= -0.6;
                    } else if (currentPhase === PHASES.PHASE2) {
                        weeklyProgress = Math.max(100 - Math.abs(weeklyChange / 0.2) * 100, 0);
                        isOnTrack = Math.abs(weeklyChange) <= 0.3;
                    } else {
                        weeklyProgress = Math.min((weeklyChange / 0.30) * 100, 100);
                        isOnTrack = weeklyChange >= 0.25 && weeklyChange <= 0.40;
                    }
                    
                    document.getElementById('weeklyProgress').style.width = weeklyProgress + '%';
                    
                    if (isOnTrack) {
                        document.getElementById('weeklyStatus').textContent = '‚úì Parfait';
                        document.getElementById('weeklyStatus').className = 'goal-status status-on-track';
                    } else {
                        document.getElementById('weeklyStatus').textContent = '‚ö† Ajuster';
                        document.getElementById('weeklyStatus').className = 'goal-status status-warning';
                    }
                }
                
                // Waist progress
                if (latestEntry.waist && weightData[0].waist) {
                    const waistChange = latestEntry.waist - weightData[0].waist;
                    const changeSign = waistChange >= 0 ? '+' : '';
                    document.getElementById('waistChange').textContent = changeSign + waistChange.toFixed(1) + 'cm';
                }
            }
            
            updateMainChart();
            updatePhaseChart();
            updateStrengthChart();
            updateHistory();
        }
        
        // Update main chart (6 months)
        let mainChartInstance = null;
        function updateMainChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            
            if (mainChartInstance) {
                mainChartInstance.destroy();
            }
            
            const labels = [];
            const actualWeights = [];
            const expectedWeights = [];
            
            // Show from PRESTART (19 d√©c) to end, weekly intervals
            for (let d = new Date(PHASES.PRESTART.start); d <= PHASES.PHASE3.end; d.setDate(d.getDate() + 7)) {
                const dateStr = d.toISOString().split('T')[0];
                labels.push(dateStr);
                expectedWeights.push(getExpectedWeight(new Date(dateStr)));
                
                // Get closest weight entry
                const entry = weightData.find(e => {
                    const entryDate = new Date(e.date);
                    return Math.abs(entryDate - d) < 3.5 * 24 * 60 * 60 * 1000;
                });
                actualWeights.push(entry ? entry.weight : null);
            }
            
            mainChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Poids R√©el',
                            data: actualWeights,
                            borderColor: '#ff6b35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            borderWidth: 3,
                            pointRadius: 6,
                            pointBackgroundColor: '#ff6b35',
                            tension: 0.4,
                            spanGaps: true
                        },
                        {
                            label: 'Objectif',
                            data: expectedWeights,
                            borderColor: '#4ecdc4',
                            backgroundColor: 'rgba(78, 205, 196, 0.05)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    aspectRatio: 2.5,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#a8b2d1',
                                font: { size: 14, weight: '600' }
                            }
                        },
                        tooltip: {
                            backgroundColor: '#1a1f3a',
                            titleColor: '#ffffff',
                            bodyColor: '#a8b2d1',
                            borderColor: '#2d3561',
                            borderWidth: 1,
                            padding: 12
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#2d3561', drawBorder: false },
                            ticks: {
                                color: '#a8b2d1',
                                maxTicksLimit: 15,
                                callback: function(value) {
                                    const date = new Date(this.getLabelForValue(value));
                                    return date.getDate() + '/' + (date.getMonth() + 1);
                                }
                            }
                        },
                        y: {
                            grid: { color: '#2d3561', drawBorder: false },
                            ticks: {
                                color: '#a8b2d1',
                                callback: function(value) {
                                    return value.toFixed(0) + 'kg';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update phase chart (current phase only)
        let phaseChartInstance = null;
        function updatePhaseChart() {
            const ctx = document.getElementById('phaseChart').getContext('2d');
            
            if (phaseChartInstance) {
                phaseChartInstance.destroy();
            }
            
            const currentPhase = getCurrentPhase();
            const labels = [];
            const actualWeights = [];
            const expectedWeights = [];
            
            // Show current phase + 7 days ahead
            const today = new Date();
            const endDate = new Date(Math.min(today.getTime() + 7 * 24 * 60 * 60 * 1000, currentPhase.end.getTime()));
            
            for (let d = new Date(currentPhase.start); d <= endDate; d.setDate(d.getDate() + 1)) {
                const dateStr = d.toISOString().split('T')[0];
                labels.push(dateStr);
                expectedWeights.push(getExpectedWeight(new Date(dateStr)));
                
                const entry = weightData.find(e => e.date === dateStr);
                actualWeights.push(entry ? entry.weight : null);
            }
            
            phaseChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Poids R√©el',
                            data: actualWeights,
                            borderColor: '#ff6b35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            borderWidth: 3,
                            pointRadius: 5,
                            pointBackgroundColor: '#ff6b35',
                            tension: 0.4,
                            spanGaps: true
                        },
                        {
                            label: 'Objectif',
                            data: expectedWeights,
                            borderColor: '#4ecdc4',
                            backgroundColor: 'rgba(78, 205, 196, 0.05)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    aspectRatio: 2.5,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#a8b2d1',
                                font: { size: 14, weight: '600' }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#2d3561', drawBorder: false },
                            ticks: {
                                color: '#a8b2d1',
                                maxTicksLimit: 20,
                                callback: function(value) {
                                    const date = new Date(this.getLabelForValue(value));
                                    return date.getDate() + '/' + (date.getMonth() + 1);
                                }
                            }
                        },
                        y: {
                            grid: { color: '#2d3561', drawBorder: false },
                            ticks: {
                                color: '#a8b2d1',
                                callback: function(value) {
                                    return value.toFixed(1) + 'kg';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update strength chart
        let strengthChartInstance = null;
        function updateStrengthChart() {
            const ctx = document.getElementById('strengthChart').getContext('2d');
            
            if (strengthChartInstance) {
                strengthChartInstance.destroy();
            }
            
            if (strengthData.length === 0) {
                return;
            }
            
            const labels = strengthData.map(e => {
                const d = new Date(e.date);
                return d.getDate() + '/' + (d.getMonth() + 1);
            });
            
            strengthChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Squat',
                            data: strengthData.map(e => e.squat),
                            borderColor: '#ff6b35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            borderWidth: 3,
                            pointRadius: 5,
                            tension: 0.4,
                            spanGaps: true
                        },
                        {
                            label: 'D√©velopp√© Inclin√©',
                            data: strengthData.map(e => e.bench),
                            borderColor: '#4ecdc4',
                            backgroundColor: 'rgba(78, 205, 196, 0.1)',
                            borderWidth: 3,
                            pointRadius: 5,
                            tension: 0.4,
                            spanGaps: true
                        },
                        {
                            label: 'Soulev√© de Terre',
                            data: strengthData.map(e => e.deadlift),
                            borderColor: '#a855f7',
                            backgroundColor: 'rgba(168, 85, 247, 0.1)',
                            borderWidth: 3,
                            pointRadius: 5,
                            tension: 0.4,
                            spanGaps: true
                        },
                        {
                            label: 'Presse',
                            data: strengthData.map(e => e.press),
                            borderColor: '#ffd166',
                            backgroundColor: 'rgba(255, 209, 102, 0.1)',
                            borderWidth: 3,
                            pointRadius: 5,
                            tension: 0.4,
                            spanGaps: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    aspectRatio: 2.5,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#a8b2d1',
                                font: { size: 14, weight: '600' }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#2d3561', drawBorder: false },
                            ticks: { color: '#a8b2d1' }
                        },
                        y: {
                            grid: { color: '#2d3561', drawBorder: false },
                            ticks: {
                                color: '#a8b2d1',
                                callback: function(value) {
                                    return value + 'kg';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update history table
        function updateHistory() {
            const tbody = document.getElementById('historyBody');
            
            if (weightData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">Aucune donn√©e enregistr√©e</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            
            for (let i = weightData.length - 1; i >= 0; i--) {
                const entry = weightData[i];
                const row = document.createElement('tr');
                
                const variation = i > 0 ? entry.weight - weightData[i-1].weight : 0;
                const variationClass = variation < 0 ? 'trend-down' : variation > 0 ? 'trend-up' : '';
                const variationText = variation !== 0 ? (variation > 0 ? '+' : '') + variation.toFixed(1) + 'kg' : '-';
                
                row.innerHTML = `
                    <td>${new Date(entry.date).toLocaleDateString('fr-FR')}</td>
                    <td>${entry.phase}</td>
                    <td>${entry.weight.toFixed(1)}kg</td>
                    <td class="${variationClass}">${variationText}</td>
                    <td>${entry.waist ? entry.waist.toFixed(1) + 'cm' : '-'}</td>
                    <td>${entry.calories > 0 ? entry.calories + 'kcal' : 'Libre'}</td>
                `;
                
                tbody.appendChild(row);
            }
        }
        
        // Initialize
        updateDashboard();
    </script>
</body>
</html>